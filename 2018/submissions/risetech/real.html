<!DOCTYPE html>
<html>
    <head>
        <title>Javascript - Add HTML Table Row </title>
        <meta charset="windows-1252">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <script src="js/stellar-sdk.js"></script>
        <script src="js/jquery.js"></script>
        <!-- Latest compiled and minified CSS -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
        
        <script>
            var p_k = window.location.href;
            p_k = p_k.substring(p_k.indexOf("=")+1)
            GetAccount(p_k);
            
            function addRow()
            {
                // get input values
                var selling = document.getElementById('selling').value;
                 var buying = document.getElementById('buying').value;
                  var amount = document.getElementById('amount').value;
                  var price = document.getElementById('price').value;
                  
                  // get the html table
                  // 0 = the first table
                  var table = document.getElementById('offer');
                  
                  // add new empty row to the table
                  // 0 = in the top 
                  // table.rows.length = the end
                  // table.rows.length/2+1 = the center
                  var newRow = table.insertRow(table.rows.length/2+1);
                  
                  // add cells to the row
                  var cel1 = newRow.insertCell(0);
                  var cel2 = newRow.insertCell(1);
                  var cel3 = newRow.insertCell(2);
                  var cel4 = newRow.insertCell(3);
                  
                  // add values to the cells
                  cel1.innerHTML = selling;
                  cel2.innerHTML = buying;
                  cel3.innerHTML = amount;
                  cel4.innerHTML = price;
            }
            
	     	function GetAccount(public_key){
//			 alert(public_key);
			var server = new StellarSdk.Server('https://horizon-testnet.stellar.org');

			// the JS SDK uses promises for most actions, such as retrieving an account
			server.loadAccount(public_key).then(function(account) {
//				$(".panel-title").html(`Getting Balances for account: ${public_key}`);
				
				account.balances.forEach(function(balance) {
                    console.log(balance);
					//console.log('Type:', balance.asset_type, ', Balance:', balance.balance);
//					$("table").append(`<tr class='success'><td>${balance.asset_type}</td><td>${balance.balance}</td></tr>`);
					$("#selling").append(`<option>${!balance.asset_code?'XLM':balance.asset_code}<option>`);
					$("#buying").append(`<option>${balance.limit}<option>`);
				});

			});

		}
            
        </script>
        
    </head>

    <body style="background-color: rgba(0,0,0,.5)">
      <div class="col-xs-4 col-xs-offset-4 well" style="margin-top:5%">
        <h3 class="text-center">MAKE AN OFFER</h3>
        <select name="select" id="selling" class="form-control"></select>
        <br>
        <select name="select" id="buying" class="form-control"></select>
        <br>

        <!-- First Name: <input type="text" name="fname" id="selling" /><br/><br/>-->
        <!-- Last Name: <input type="text" name="lname" id="buying" /><br/><br/>-->
        
        <input type="text" name="age" id="amount" class="form-control" placeholder="AMOUNT" />
        <br>
        <input type="text" name="age" id="price" class="form-control" placeholder="PRICE" /> 
        <br>   
        <button onclick="addRow()" class="btn btn-primary">Add Row</button>
        <br><br>
        <table id="offer" class="table table-bordered">
            <tr>
                <th>selling</th>
                <th>buying</th>
                <th>amount</th>
                <th>price</th>
            </tr>
        </table>
        
      </div>


        </body>

</html>
